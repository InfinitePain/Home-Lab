# yaml-language-server: $schema=https://goauthentik.io/blueprints/schema.json
version: 1
metadata:
  name: password-and-mfa-loose-authentication
context: {}
entries:
  - attrs:
      authentication: none
      compatibility_mode: true
      denied_action: message_continue
      designation: authentication
      layout: stacked
      name: Password and MFA Loose Authentication
      policy_engine_mode: any
      title: Welcome to Authentik!
    conditions: []
    identifiers:
      pk: f855ccd9-df19-4560-993a-1af6d387349a
      slug: password-and-mfa-loose-authentication
    model: authentik_flows.flow
    state: created

  - attrs:
      expression: "flow_plan = request.context.get(\"flow_plan\")\nif not flow_plan:\n\
        \    return True\n# If the user does not have a backend attached to it, they\
        \ haven't\n# been authenticated yet and we need the password stage\nreturn not\
        \ hasattr(flow_plan.context.get(\"pending_user\"), \"backend\")"
      name: default-authentication-flow-password-stage
    conditions: []
    identifiers:
      pk: d7dd02ff-47af-408d-9047-3288c8541a06
    model: authentik_policies_expression.expressionpolicy
    state: created

  - attrs:
      check_ip: true
      name: Reputation Policy
      threshold: -5
    conditions: []
    identifiers:
      pk: d1bde141-9dcc-470e-97d2-ba05a8f596a0
    model: authentik_policies_reputation.reputationpolicy
    state: created

  - attrs:
      geoip_binding: no_binding
      network_binding: no_binding
      remember_me_offset: seconds=0
      session_duration: seconds=0
    conditions: []
    identifiers:
      name: default-authentication-login
      pk: 86bbb0b2-b307-41b3-92bb-0d077e58a576
    model: authentik_stages_user_login.userloginstage
    state: created

  - attrs:
      backends:
      - authentik.core.auth.InbuiltBackend
      - authentik.core.auth.TokenBackend
      - authentik.sources.ldap.auth.LDAPBackend
      configure_flow: f1e54046-b6a0-46e5-b843-9448fc6f8cc7
      failed_attempts_before_cancel: 3
    conditions: []
    identifiers:
      name: default-authentication-password
      pk: e6a5e130-c364-4ff2-93eb-df9dc8e1efa9
    model: authentik_stages_password.passwordstage
    state: created

  - attrs:
      configuration_stages:
      - c40b3598-c0a1-4fbf-b82b-f6d7750a9d7b
      device_classes:
      - static
      - totp
      - webauthn
      last_auth_threshold: seconds=0
      not_configured_action: skip
      webauthn_user_verification: preferred
    conditions: []
    identifiers:
      name: TOTP / WebAuthn Validation Continue Stage
      pk: 3fb67a77-1929-4750-89b4-3132cfbba42a
    model: authentik_stages_authenticator_validate.authenticatorvalidatestage
    state: created

  - attrs:
      case_insensitive_matching: true
      pretend_user_exists: true
      show_matched_user: true
      user_fields:
      - email
      - username
    conditions: []
    identifiers:
      name: default-authentication-identification
      pk: 9b72014d-1bc2-41b7-bbc2-0a2c4e86fdde
    model: authentik_stages_identification.identificationstage
    state: created

  - attrs:
      invalid_response_action: retry
      policy_engine_mode: any
      re_evaluate_policies: true
    conditions: []
    identifiers:
      order: 10
      pk: 17a74816-5cba-4ef8-b674-a3489a56cfa8
      stage: 9b72014d-1bc2-41b7-bbc2-0a2c4e86fdde
      target: f855ccd9-df19-4560-993a-1af6d387349a
    model: authentik_flows.flowstagebinding
    state: created

  - attrs:
      invalid_response_action: retry
      policy_engine_mode: any
      re_evaluate_policies: true
    conditions: []
    identifiers:
      order: 20
      pk: b9050bae-8cc0-452b-9f5b-517f349facd4
      stage: e6a5e130-c364-4ff2-93eb-df9dc8e1efa9
      target: f855ccd9-df19-4560-993a-1af6d387349a
    model: authentik_flows.flowstagebinding
    state: created

  - attrs:
      invalid_response_action: retry
      policy_engine_mode: any
      re_evaluate_policies: true
    conditions: []
    identifiers:
      order: 30
      pk: 1a148467-70a4-403b-9822-9450cab3d0b8
      stage: 3fb67a77-1929-4750-89b4-3132cfbba42a
      target: f855ccd9-df19-4560-993a-1af6d387349a
    model: authentik_flows.flowstagebinding
    state: created

  - attrs:
      invalid_response_action: retry
      policy_engine_mode: any
      re_evaluate_policies: true
    conditions: []
    identifiers:
      order: 100
      pk: 202338aa-b967-421f-a51a-3a24922922ba
      stage: 86bbb0b2-b307-41b3-92bb-0d077e58a576
      target: f855ccd9-df19-4560-993a-1af6d387349a
    model: authentik_flows.flowstagebinding
    state: created

  - attrs:
      enabled: true
      negate: true
      timeout: 30
    conditions: []
    identifiers:
      order: 0
      pk: adf69fcc-84e9-4419-8a71-10c532e884b0
      policy: d1bde141-9dcc-470e-97d2-ba05a8f596a0
      target: f855ccd9-df19-4560-993a-1af6d387349a
    model: authentik_policies.policybinding
    state: created

  - attrs:
      enabled: true
      timeout: 30
    conditions: []
    identifiers:
      order: 10
      pk: 7148771e-9cb6-4fa2-bfb7-d3c151b43fd5
      policy: d7dd02ff-47af-408d-9047-3288c8541a06
      target: b9050bae-8cc0-452b-9f5b-517f349facd4
    model: authentik_policies.policybinding
    state: created

  - attrs:
      enabled: true
      group: 7155b346-321b-43c7-a785-03297ea06c46
      negate: true
      timeout: 30
    conditions: []
    identifiers:
      order: 0
      pk: 977bfd0c-34ad-443d-b516-6d26a5edada2
      target: 1a148467-70a4-403b-9822-9450cab3d0b8
    model: authentik_policies.policybinding
    state: created
